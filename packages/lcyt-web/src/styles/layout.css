/* CSS custom properties — dark theme (default) */
:root {
  --mobile-bar-height: 52px;
  --color-bg: #0f1117;
  --color-surface: #1a1d27;
  --color-surface-elevated: #22263a;
  --color-border: #2e3250;
  --color-accent: #4f8ef7;
  --color-accent-dim: #2d5ab0;
  --color-success: #3fb950;
  --color-warning: #e3b341;
  --color-error: #f85149;
  --color-text: #e6edf3;
  --color-text-dim: #7d8590;
  --color-text-muted: #484f58;
  --color-active-line: #1f3a5f;
  --color-active-line-border: #4f8ef7;
  --color-sent-flash: #1a3a1f;

  --header-height: 44px;
  --footer-height: 52px;
  --tab-height: 36px;
  --font-mono: 'Cascadia Code', 'Fira Code', 'Consolas', 'Menlo', monospace;
  --font-ui: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
}

/* Light theme override */
@media (prefers-color-scheme: light) {
  :root:not([data-theme="dark"]) {
    --color-bg: #ffffff;
    --color-surface: #f6f8fa;
    --color-surface-elevated: #ffffff;
    --color-border: #d0d7de;
    --color-accent: #0969da;
    --color-accent-dim: #218bff;
    --color-success: #1a7f37;
    --color-warning: #9a6700;
    --color-error: #cf222e;
    --color-text: #1f2328;
    --color-text-dim: #57606a;
    --color-text-muted: #8c959f;
    --color-active-line: #dbeafe;
    --color-active-line-border: #0969da;
    --color-sent-flash: #dcfce7;
  }
}

/* Manual light theme */
:root[data-theme="light"] {
  --color-bg: #ffffff;
  --color-surface: #f6f8fa;
  --color-surface-elevated: #ffffff;
  --color-border: #d0d7de;
  --color-accent: #0969da;
  --color-accent-dim: #218bff;
  --color-success: #1a7f37;
  --color-warning: #9a6700;
  --color-error: #cf222e;
  --color-text: #1f2328;
  --color-text-dim: #57606a;
  --color-text-muted: #8c959f;
  --color-active-line: #dbeafe;
  --color-active-line-border: #0969da;
  --color-sent-flash: #dcfce7;
}

/* ─── App shell ─────────────────────────────────────────── */

body {
  background: var(--color-bg);
  color: var(--color-text);
  font-family: var(--font-ui);
}

#app {
  display: grid;
  grid-template-rows: var(--header-height) 1fr var(--footer-height);
  height: 100vh;
  overflow: hidden;
}

/* ─── Header ────────────────────────────────────────────── */

#header {
  background: var(--color-surface);
  border-bottom: 1px solid var(--color-border);
  display: flex;
  align-items: center;
  padding: 0 12px;
  gap: 12px;
  overflow: hidden;
  flex-shrink: 0;
}

/* ─── Main two-column layout ────────────────────────────── */

#main {
  display: grid;
  grid-template-columns: 60fr 40fr;
  overflow: hidden;
}

.panel {
  display: flex;
  flex-direction: column;
  overflow: hidden;
}

.panel--left {
  border-right: 1px solid var(--color-border);
}

/* ─── Footer / input bar ────────────────────────────────── */

#footer {
  background: var(--color-surface);
  border-top: 1px solid var(--color-border);
  display: flex;
  align-items: center;
  padding: 0 8px;
  gap: 8px;
}

/* ─── Audio panel docked at bottom of left column (desktop) ─ */

.audio-panel {
  border-top: 1px solid var(--color-border);
  background: var(--color-surface);
  flex-shrink: 0;
  padding: 10px 12px;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

/* Hidden state on desktop: remove from flow */
.audio-panel--hidden {
  display: none;
}

/* Footer audio toggle button */
.footer__audio-btn {
  flex-shrink: 0;
}

/* ─── Responsive: mobile layout (< 768px) ───────────────── */

@media (max-width: 768px) {
  /* App grid: header auto, main flex:1, footer hidden (height 0) */
  #app {
    grid-template-rows: auto 1fr 0;
  }

  /* Desktop footer hidden on mobile; replaced by #mobile-audio-bar */
  #footer {
    display: none;
  }

  /* Main area scrolls vertically */
  #main {
    display: flex;
    flex-direction: column;
    overflow-y: auto;
  }

  /* Left panel: normal flow, no fixed height */
  .panel--left {
    flex-shrink: 0;
    border-right: none;
  }

  /* Caption view capped on mobile */
  #left-panel .caption-view {
    max-height: 30vh;
  }

  /* Audio panel becomes a fixed bottom sheet on mobile */
  .audio-panel {
    position: fixed;
    bottom: var(--mobile-bar-height, 52px);
    left: 0;
    right: 0;
    z-index: 50;
    transform: translateY(100%);
    transition: transform 0.25s ease;
    border-top: 1px solid var(--color-border);
    border-radius: 12px 12px 0 0;
    box-shadow: 0 -4px 20px rgba(0,0,0,0.3);
  }

  /* On mobile, use transform for show/hide (not display:none) */
  .audio-panel--hidden {
    display: flex;
    transform: translateY(100%);
  }

  .audio-panel--open {
    transform: translateY(0);
  }

  /* Live text box hidden on mobile */
  .audio-caption-live--compact {
    display: none;
  }

  /* Right panel: normal flow in scroll area */
  .panel--right {
    display: flex;
    position: static;
    inset: auto;
    height: auto;
    min-height: 28vh;
    border-top: 1px solid var(--color-border);
    background: var(--color-bg);
    z-index: 1;
  }

  /* Pad main content so it doesn't hide behind the fixed bar */
  #main {
    padding-bottom: var(--mobile-bar-height, 52px);
  }

  /* Fixed bottom audio bar */
  #mobile-audio-bar {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    height: var(--mobile-bar-height, 52px);
    background: var(--color-surface);
    border-top: 1px solid var(--color-border);
    display: flex;
    align-items: center;
    padding: 0 12px;
    z-index: 60;
  }

  /* FAB — visible only on mobile */
  .send-fab {
    position: fixed;
    bottom: calc(var(--mobile-bar-height, 52px) + 16px);
    width: 52px;
    height: 52px;
    border-radius: 50%;
    z-index: 70;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .send-fab--right { right: 16px; }
  .send-fab--left  { left:  16px; }

  /* Allow header to expand and show wrapped status lines */
  #header {
    align-items: flex-start;
    padding: 8px 12px;
    overflow: visible;
  }
}
